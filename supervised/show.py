# -*- coding: UTF-8 -*-
"""
@author ：yqy
@Project ：seismic-semanticSegmentation
@Date ：2022/9/11 19:28
"""
# -*- coding: UTF-8 -*-
"""
@author ：yqy
@Project ：地震相实验
@Date ：2022/1/11 10:31
"""

import torch
import matplotlib.pyplot as plt
import numpy as np

#原始模型DeepLabV3+ Resnet50
iou_d3r5 = [0.8076168452877969, 0.8210294550692283, 0.8622060266775224, 0.9156612690988601, 0.8940922086886749, 0.9056966410187867, 0.935200658367844, 0.9221878873043862, 0.9321669684956329, 0.9459908911590862, 0.9334109935665832, 0.9430832920745026, 0.9508010247041939, 0.9289668391289155, 0.9436760408043003, 0.951890735531153, 0.935207418353328, 0.9490553707659074, 0.9555027079121055, 0.941128535588785, 0.9537126995078565, 0.9585993089544959, 0.9148498008513151, 0.9469313466109331, 0.9569927788656054, 0.9357028726726005, 0.9515304922755896, 0.9597203474849582, 0.9431624797849751, 0.9573269507292138, 0.9627575843297757, 0.9457375703334774, 0.9585482645062865, 0.9628785557492856, 0.9399269099884359, 0.9610927999182658, 0.9634238308499757, 0.9473580763684771, 0.95883279928878, 0.964607991413956, 0.9468750639622098, 0.9510719788702799, 0.9626601639100174, 0.9520318164151927, 0.9609915740853948]
# iou_validation1结果： [0.8217765798565783, 0.833522292501131, 0.8734474426548848, 0.9165892678857019, 0.898721329291227, 0.9033890621691887, 0.9361202573314706, 0.9226014495201171, 0.9304542155580098, 0.9464310060663991, 0.9350016303692715, 0.9413272220365236, 0.9511072894012587, 0.930014577037489, 0.9431765932456398, 0.9518020621555268, 0.9351237565795854, 0.9478532307291092, 0.9555511558547496, 0.9460334187940098, 0.9533927330358368, 0.9585624821979032, 0.917493648650451, 0.9487698366272547, 0.956920534558899, 0.9371987722380745, 0.952524007532556, 0.959831880368329, 0.9502611137205342, 0.9580552817383305, 0.9626963485581508, 0.9497788466669623, 0.9595652192411874, 0.9629514897119016, 0.949332017385619, 0.9621231032230068, 0.9649966712234495, 0.9530031482244906, 0.9641999761369977, 0.9655382146039374, 0.955780258531148, 0.9509642918327035, 0.9627305494783129, 0.9538724526495047, 0.9611687605622455]
# iou_validation2结果： [0.7936713109515088, 0.8084461240673949, 0.8510920726264551, 0.9156225551401761, 0.8898829292769583, 0.9090214663082469, 0.9350917564546934, 0.9221670363310774, 0.9342384313451365, 0.946198871281223, 0.932117428082304, 0.9449823541263008, 0.9509022602626265, 0.9280949465689986, 0.9445327558614423, 0.9523136261260078, 0.9354305010007555, 0.9503391904438427, 0.9556903389550591, 0.9363657293515875, 0.9541592258364713, 0.9589760729309958, 0.9127581988189961, 0.9452959277365514, 0.9575277078975724, 0.9343812655951333, 0.9508725945691274, 0.9599450383366136, 0.9360419094452472, 0.9569239126519411, 0.9631527953778607, 0.9417117168012055, 0.9577996346054481, 0.9630982279241274, 0.9306624130310863, 0.9604004983727549, 0.9620549015258046, 0.9415562546291227, 0.953385468171857, 0.9639898548173275, 0.9381325707491994, 0.951467028686902, 0.9629348669881438, 0.9503633228122809, 0.9610137304941656]
# loss_validation结果： [0.1523257, 0.13635378, 0.09942219, 0.059402183, 0.07966609, 0.06840061, 0.043498777, 0.05778151, 0.04696401, 0.036492635, 0.048634585, 0.03842471, 0.033014473, 0.05387479, 0.038485434, 0.032431874, 0.046695866, 0.034487337, 0.029633807, 0.042413205, 0.03128511, 0.026966555, 0.06361199, 0.036197953, 0.028633574, 0.046493527, 0.032431845, 0.026138477, 0.04450024, 0.027942402, 0.024364164, 0.038662348, 0.027563537, 0.024186462, 0.047320306, 0.025804112, 0.02364734, 0.043634698, 0.033178568, 0.02325564, 0.047120616, 0.03218921, 0.02391537, 0.033769663, 0.025311086]


#self-attention
# iou_validation结果： [0.7061716451584028, 0.8165586889001283, 0.8594448839790501, 0.9072782423351177, 0.8600234758415229, 0.9055950716879967, 0.9317321630326018, 0.9106044149797422, 0.9216798388416323, 0.9409767314797712, 0.8907721922444122, 0.927586138451995, 0.9441654991816284, 0.8168487202382236, 0.89806878947748, 0.9350933971144579, 0.918492148132639, 0.9330854708195241, 0.9449613499834584, 0.9319969439154073, 0.9421725292629342, 0.9480988773152672, 0.9334195616560014, 0.9465314892381372, 0.9510084374780541, 0.9037749937846531, 0.9421064396744216, 0.9530267700481172, 0.8922537948666832, 0.9373682918327737, 0.9520670695126136, 0.9396396500618686, 0.9500697999465254, 0.9564832389925942, 0.9304074376539753, 0.9520997221008943, 0.958544660246039, 0.9421485829739008, 0.9536613988854857, 0.9603914594671107, 0.8855641329700226, 0.9396650127755872, 0.9543797279412878, 0.9381787050577984, 0.9523308362643725]
# iou_validation1结果： [0.7194772795415668, 0.8246876496532586, 0.8631092791651437, 0.9117980245955335, 0.8633930970079662, 0.9036992865905986, 0.9334210740919294, 0.9113534637685261, 0.9198312974758165, 0.9413691536671702, 0.8892206689796385, 0.9270346649259518, 0.9441938784806988, 0.8312940887478517, 0.9002598502398185, 0.9362724229988639, 0.9204449390209474, 0.9342284355495973, 0.9455739186783374, 0.9337127701891156, 0.9420498719031964, 0.9483771097284357, 0.934419186047801, 0.9469701587679662, 0.9511276204171312, 0.9110534375989211, 0.942526124957582, 0.9532013945634794, 0.8984586135488668, 0.9380293979230329, 0.9517632221805916, 0.9409314675544836, 0.9490355846004983, 0.9565383757900576, 0.9344817039409186, 0.9524454270763721, 0.9585797469232011, 0.9439889773363352, 0.9535389517360482, 0.9599574139748457, 0.8866078280669359, 0.9396206774810223, 0.9545807513433703, 0.938377372995874, 0.9522382485585015]
# iou_validation2结果： [0.6922221133835287, 0.8078050089051235, 0.855912539101455, 0.9035365877562429, 0.857088374930909, 0.9074944243315668, 0.9305752721761188, 0.9104214411406287, 0.9238314493351479, 0.9411048343733329, 0.8927318863336071, 0.9286062335677954, 0.9447974141577861, 0.8017872375516971, 0.8964644690978103, 0.9345732093952159, 0.9169067214954906, 0.9323371164926219, 0.9449497051655633, 0.9308097196585395, 0.9427855666557015, 0.9484292757794404, 0.9328231384167924, 0.9463729157140696, 0.9515408659610305, 0.8972422104202806, 0.9419938958691493, 0.9534031698086991, 0.8866149801362413, 0.9370230662369364, 0.9527780111879063, 0.9388597861417868, 0.9514518747754547, 0.956957350139883, 0.9269709482081178, 0.9521176867602256, 0.9589919569624886, 0.9407954620890789, 0.9542767582356827, 0.9614602034892027, 0.8847357956963032, 0.9400024914132417, 0.9548362053621086, 0.9385398687552152, 0.9528161672545847]
# loss_validation结果： [0.2994843, 0.15902737, 0.10329955, 0.06627748, 0.10562509, 0.06510784, 0.046330895, 0.06824662, 0.05317005, 0.039881673, 0.081795104, 0.048870254, 0.03713341, 0.16914144, 0.07232919, 0.044640932, 0.060109917, 0.04554557, 0.03652698, 0.047331173, 0.03874977, 0.033519067, 0.046160426, 0.035664488, 0.031698775, 0.076073684, 0.039099395, 0.030484764, 0.09023948, 0.042225104, 0.031343114, 0.041251574, 0.03240049, 0.027908683, 0.050969023, 0.031253796, 0.026499514, 0.041189075, 0.030445203, 0.025358485, 0.08945917, 0.04114696, 0.029333876, 0.04309087, 0.031240812]

iou_self=[0.6872887641226398, 0.8136107508408753, 0.8276315288194243, 0.914292123233464, 0.8766195553156366, 0.9119763622204036, 0.9362461956549214, 0.8971222203747603, 0.9262057697491274, 0.9431703339654418, 0.9072251888818138, 0.9346950432366783, 0.9473984304407548, 0.8875175378057368, 0.9260290206631442, 0.9474697890673571, 0.8631774181792589, 0.9227683450458133, 0.9441752225094868, 0.9159365016671431, 0.9367292344403706, 0.9496199900476695, 0.932789617017509, 0.943726102536319, 0.9528190914283543, 0.9137064390456922, 0.94320470432734, 0.9548714121535279, 0.8560778167373962, 0.9222558665850774, 0.9451964947825728, 0.9368396224432722, 0.9459753589884539, 0.953536819006292, 0.9442222504548341, 0.9504793647882381, 0.9578945928463629, 0.9331182031841485, 0.9485121008012832, 0.9583518522003164, 0.9440071094911706, 0.9549588456583451, 0.960460449409213, 0.9382284839150206, 0.9528796985115906]


plt.figure(figsize=(8, 8), dpi=80)
plt.figure(1)

ax2 = plt.subplot(221)
plt.plot(iou_d3r5)
plt.plot(iou_self)
plt.legend(["DeepLabV3+","Attention"], loc='lower right')


# ax6 = plt.subplot(222)
# plt.plot(validation_class_aveJ['one'])
# plt.plot(validation_class_aveJ['two'])
# plt.plot(validation_class_aveJ['three'])
# plt.plot(validation_class_aveJ['four'])
# plt.plot(validation_class_aveJ['five'])
# plt.plot(validation_class_aveJ['six'])
# plt.plot(validation_class_aveJ['seven'])
# plt.plot(validation_class_aveJ['eight'])
# plt.plot(validation_class_aveJ['nine'])
# plt.plot(validation_class_aveJ['ten'])
# plt.legend(['1','2','3','4','5','6','7','8','9','10'], loc='lower right')


plt.show()